#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <locale.h>
#define NUM_OF_USERS 10
char cpf[12];
char senha[6];
char cpf_lista[NUM_OF_USERS][12];
char senha_lista[NUM_OF_USERS][7];
int indice;
int i = 0;
// apenas senha e cpf
void inciacao_arquivos() {
  char linha[100];
  FILE *cpfss;
  cpfss = fopen("cpfs.bin", "rb");

  for(i=0;i<NUM_OF_USERS && fgets(linha,sizeof(linha), cpfss);i++) {
    linha[ strcspn(linha, "\n")]='\0';
      strcpy(cpf_lista[i], linha);

    };
  fclose(cpfss);




  FILE *senhass;
  senhass = fopen("senhas.bin", "rb");

  for (i=0;i<NUM_OF_USERS && fgets(linha,sizeof(linha), senhass);i++) {
    linha[strcspn(linha, "\n")]='\0';

      strcpy(senha_lista[i], linha);

    };

  fclose(senhass);

};
void login(){
  while (1){
    printf("BEM VINDO!!\n");
    printf("Digite seu CPF: ");
    scanf("%11s", cpf);
    printf("Digite sua senha: ");
    scanf("%6s", senha);
    
    for (int i = 0; i < NUM_OF_USERS; i++) {
      if (strcmp(cpf_lista[i], cpf)== 0) {
        if (strcmp(senha_lista[i],senha)==0){
          printf("Login realizado com sucesso!\n");
            int indice = i;
          return;
        }

    
      
      }
    }
    printf("CPF ou senha incorretos!\n");
    
  }
}



// leitura dos extratos na função extratos

void extrato() {
    FILE *extratobanco;
    
    char linha[1000]; 

    extratobanco = fopen("extrato.bin", "rb");
    if (extratobanco == NULL) {
        printf("Erro ao abrir o arquivo.\n");
        return 1;
    }

    while (fgets(linha, sizeof(linha), extratobanco) != NULL) {

        char *espaco = strchr(linha, ' '); 
        if (espaco != NULL) {
            *espaco = '\0'; 

            if (strcmp(linha, cpf) == 0) {
                printf("%s\n", espaco + 1); 
            }
        }
    }

    fclose(extratobanco);
    printf("\n<--- volte com 'ENTER'\n");
    getchar(); 
    return 0;
}
